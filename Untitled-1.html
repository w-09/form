<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
  <title>營造業人員進場登記</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css" rel="stylesheet">
  <style>
      /* 原有的 CSS 保持不變 */
  </style>
</head>
<body>
  <!-- 原有的 HTML 結構保持不變 -->
  <script>
    // 更新 Google Apps Script 部署網址
    const APPS_SCRIPT_URL = '你的Google Apps Script部署網址';

    // 其他 JavaScript 程式碼保持不變
    // 批次上傳部分可以稍作調整
    document.getElementById('submitAllBtn').addEventListener('click', async function() {
        if (workers.length === 0) {
            alert('請先新增工人');
            return;
        }

        const submitButton = document.getElementById('submitAllBtn');
        submitButton.disabled = true;
        submitButton.innerHTML = '<i class="bi bi-cloud-upload"></i> 上傳中…';

        try {
            const response = await fetch(APPS_SCRIPT_URL, {
                method: 'POST',
                mode: 'no-cors', // 重要：處理跨域問題
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(workers)
            });

            // 由於使用 no-cors 模式，需要調整錯誤處理
            alert('資料上傳處理中，請稍候');
            
            workers = []; // 清空陣列
            updateWorkerTable();
        } catch (error) {
            console.error('上傳發生錯誤:', error);
            alert('上傳發生錯誤：' + error.message);
        } finally {
            setTimeout(() => {
                submitButton.disabled = false;
                submitButton.innerHTML = '<i class="bi bi-cloud-upload"></i> 批次上傳';
            }, 3000);
        }
    });
  </script>
</body>
</html>
