<!DOCTYPE html>
<html>
<head>
  <title>測試 Google Apps Script 連接</title>
</head>
<body>
  <h2>測試 Google Apps Script 連接</h2>
  
  <button id="testGet">測試 GET 請求</button>
  <button id="testPost">測試 POST 請求</button>
  
  <div id="result" style="margin-top: 20px; padding: 10px; border: 1px solid #ccc;"></div>
  
  <script>
    const APPS_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbxtW_mcVvsPUwK9nw2axd9CmW-hGymmO9qut8iD-CKnMw7LaybouZLIuzaqFRtCA1vs/exec';
    
    document.getElementById('testGet').addEventListener('click', async function() {
      document.getElementById('result').textContent = '正在測試 GET 請求...';
      
      try {
        const response = await fetch(APPS_SCRIPT_URL);
        const text = await response.text();
        document.getElementById('result').textContent = '成功! 回應: ' + text.substring(0, 100) + '...';
      } catch (error) {
        document.getElementById('result').textContent = '錯誤: ' + error.message;
      }
    });
    
    document.getElementById('testPost').addEventListener('click', function() {
      document.getElementById('result').textContent = '正在測試 POST 請求...';
      
      // 使用表單提交方式
      const form = document.createElement('form');
      form.method = 'POST';
      form.action = APPS_SCRIPT_URL;
      form.target = 'hidden-iframe';
      form.style.display = 'none';
      
      // 創建隱藏的 iframe 接收回應
      let iframe = document.getElementById('hidden-iframe');
      if (!iframe) {
        iframe = document.createElement('iframe');
        iframe.name = 'hidden-iframe';
        iframe.id = 'hidden-iframe';
        iframe.style.display = 'none';
        document.body.appendChild(iframe);
      }
      
      // 監聽 iframe 載入事件
      iframe.onload = function() {
        document.getElementById('result').textContent = '表單提交完成，請檢查 Google 試算表是否有新資料';
      };
      
      // 創建測試資料
      const input = document.createElement('input');
      input.type = 'hidden';
      input.name = 'data';
      input.value = JSON.stringify([{
        name: '測試人員',
        type: '測試工種',
        company: '測試公司',
        entryTime: new Date().toLocaleString()
      }]);
      
      form.appendChild(input);
      document.body.appendChild(form);
      form.submit();
    });
  </script>
</body>
</html>
